<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Python 相关知识">
<meta property="og:type" content="article">
<meta property="og:title" content="Python">
<meta property="og:url" content="http://example.com/2024/02/19/Python/index.html">
<meta property="og:site_name" content="随笔">
<meta property="og:description" content="Python 相关知识">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-02-19T07:35:08.000Z">
<meta property="article:modified_time" content="2024-02-19T07:36:00.187Z">
<meta property="article:author" content="Bling">
<meta property="article:tag" content="编程语言">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2024/02/19/Python/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Python | 随笔</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">随笔</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/02/19/Python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Bling">
      <meta itemprop="description" content="绳锯木断，水滴石穿">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随笔">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Python
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-02-19 15:35:08 / 修改时间：15:36:00" itemprop="dateCreated datePublished" datetime="2024-02-19T15:35:08+08:00">2024-02-19</time>
            </span>

          
            <div class="post-description">Python 相关知识</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="函数参数传递"><a href="#函数参数传递" class="headerlink" title="函数参数传递"></a>函数参数传递</h1><p>主要注意两点</p>
<ul>
<li>当一个引用传递给函数时，函数自动复制一份引用</li>
<li>在 Python 中，string、tuple 和 number（int、float、bool、complex）是不可更改对象，而 list、dict、set 是可更改对象。对可更改的引用对象的修改是可以传递的</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;val: &#123;&#125;, address: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(a, <span class="built_in">id</span>(a)))  <span class="comment"># val: 1, address: 4329957680</span></span><br><span class="line">    a = <span class="number">2</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;val: &#123;&#125;, address: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(a, <span class="built_in">id</span>(a)))  <span class="comment"># val: 2, address: 4329957712</span></span><br><span class="line">func(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;val: &#123;&#125;, address: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(a, <span class="built_in">id</span>(a)))  <span class="comment"># val: 1, address: 4329957680</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;val: &#123;&#125;, address: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(a, <span class="built_in">id</span>(a)))  <span class="comment"># val: [1], address: 4368392512</span></span><br><span class="line">    a.append(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;val: &#123;&#125;, address: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(a, <span class="built_in">id</span>(a)))  <span class="comment"># val: [1, 2], address: 4368392512</span></span><br><span class="line">func(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;val: &#123;&#125;, address: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(a, <span class="built_in">id</span>(a)))  <span class="comment"># val: [1, 2], address: 4368392512</span></span><br></pre></td></tr></table></figure>



<h1 id="type-函数"><a href="#type-函数" class="headerlink" title="type 函数"></a>type 函数</h1><p>两个作用</p>
<ul>
<li>查看一个类型或变量的类型</li>
<li>创建类</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (类的名字, 类继承的父类集合, 类的方法集合)</span></span><br><span class="line">Hello = <span class="built_in">type</span>(<span class="string">&quot;Hello&quot;</span>, (<span class="built_in">object</span>,), &#123;<span class="string">&quot;hello&quot;</span>: hello&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(Hello))  <span class="comment"># &lt;class &#x27;type&#x27;&gt;</span></span><br><span class="line">h = Hello()</span><br><span class="line">h.hello()  <span class="comment"># Hello World!</span></span><br></pre></td></tr></table></figure>



<h1 id="new-和-init"><a href="#new-和-init" class="headerlink" title="__new__ 和 __init__"></a><code>__new__</code> 和 <code>__init__</code></h1><p><code>__new__</code>：用于创建类的实例，是一个静态方法，需要返回类的实例对象，否则不会调用新实例的 <code>__init__</code> 方法</p>
<p><code>__init__</code>：用于初始化类的实例，返回 <code>None</code> 值（否则会抛出 <code>TypeError</code>）</p>
<h1 id="元类（Metaclass）"><a href="#元类（Metaclass）" class="headerlink" title="元类（Metaclass）"></a>元类（Metaclass）</h1><p>用于创建类或者修改类。类可以被看成是元类创建出来的“实例”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># metaclass 是类的模板，必须从 type 类型派生</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ListMetaclass</span>(<span class="title class_ inherited__">type</span>):</span><br><span class="line">    <span class="comment"># (当前准备创建的类的对象, 类的名字, 类继承的父类集合, 类的方法集合)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, name, bases, attrs</span>):</span><br><span class="line">        attrs[<span class="string">&quot;add&quot;</span>] = <span class="keyword">lambda</span> self, value: self.append(value)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>.__new__(cls, name, bases, attrs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyList</span>(<span class="built_in">list</span>, metaclass=ListMetaclass):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">l = MyList()</span><br><span class="line">l.add(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(l)  <span class="comment"># [1]</span></span><br></pre></td></tr></table></figure>



<h1 id="静态方法、类方法和实例方法"><a href="#静态方法、类方法和实例方法" class="headerlink" title="静态方法、类方法和实例方法"></a>静态方法、类方法和实例方法</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">a</span>():</span><br><span class="line">        <span class="string">&quot;&quot;&quot;静态方法&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">b</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;类方法&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">c</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;实例方法&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p><code>self</code> 和 <code>cls</code> 可以替换成别的参数，但一般 Python 约定是这两</p>
<h1 id="类变量和实例变量"><a href="#类变量和实例变量" class="headerlink" title="类变量和实例变量"></a>类变量和实例变量</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    num_of_instance = <span class="number">0</span>  <span class="comment"># 类变量，可在类的所有实例之间共享的值</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.name = name  <span class="comment"># 实例变量</span></span><br><span class="line">        Person.num_of_instance += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Person.num_of_instance)  <span class="comment"># 0</span></span><br><span class="line">p1 = Person(<span class="string">&quot;Jack&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(p1.num_of_instance)  <span class="comment"># 1</span></span><br><span class="line">p2 = Person(<span class="string">&quot;Jason&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(p2.num_of_instance)  <span class="comment"># 2</span></span><br><span class="line"><span class="comment"># name: Jack, num_of_instance: 2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;name: %s, num_of_instance: %d&quot;</span> % (p1.name, p1.num_of_instance))</span><br><span class="line"><span class="comment"># name: Jacson, num_of_instance: 2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;name: %s, num_of_instance: %d&quot;</span> % (p2.name, p2.num_of_instance))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    name = <span class="string">&quot;Jack&quot;</span></span><br><span class="line"></span><br><span class="line">p1, p2 = Person(), Person()</span><br><span class="line">p1.name = <span class="string">&quot;Jason&quot;</span></span><br><span class="line"><span class="built_in">print</span>(p1.name)  <span class="comment"># Jason. 和函数传参类似，原本引用的是类变量，现在引用发生变化，变成实例变量</span></span><br><span class="line"><span class="built_in">print</span>(p2.name)  <span class="comment"># Jack</span></span><br><span class="line"><span class="built_in">print</span>(Person.name)  <span class="comment"># Jack</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    order = []</span><br><span class="line"></span><br><span class="line">p1, p2 = Person(), Person()</span><br><span class="line">p1.order.append(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(p1.order)  <span class="comment"># [1]</span></span><br><span class="line"><span class="built_in">print</span>(p2.order)  <span class="comment"># [1]</span></span><br><span class="line"><span class="built_in">print</span>(Person.order)  <span class="comment"># [1]</span></span><br></pre></td></tr></table></figure>



<h1 id="自省机制"><a href="#自省机制" class="headerlink" title="自省机制"></a>自省机制</h1><p>程序在运行时能够获知对象的类型或属性的能力</p>
<p><code>dir()</code>：返回指定对象的（经过排序的）属性列表。如果不指定对象，则返回当前作用域中的属性列表</p>
<p><code>type()</code>：返回指定对象的类型</p>
<p><code>hasattr()</code>：测试一个或多个属性是否存在</p>
<p><code>getattr()</code>：获取某个属性的属性值</p>
<p><code>id()</code>：返回对象的唯一标识符</p>
<p><code>isinstance()</code>：确定一个对象是否是某个特定类型或定制类的实例</p>
<p><code>issubclass()</code>：检查特定的类是否是另一个类的派生类</p>
<p><code>callable()</code>：确定一个对象是否是可调用的</p>
<h1 id="推导式"><a href="#推导式" class="headerlink" title="推导式"></a>推导式</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列表推导式</span></span><br><span class="line">[val <span class="keyword">for</span> val <span class="keyword">in</span> arr <span class="keyword">if</span> val &lt; <span class="number">10</span>]</span><br><span class="line"><span class="comment"># 元组推导式</span></span><br><span class="line">(val <span class="keyword">for</span> val <span class="keyword">in</span> arr <span class="keyword">if</span> val &lt; <span class="number">10</span>)</span><br><span class="line"><span class="comment"># 字典推导式</span></span><br><span class="line">&#123;k: v <span class="keyword">for</span> k, v <span class="keyword">in</span> obj.items() <span class="keyword">if</span> k &lt; <span class="number">10</span>&#125;</span><br><span class="line"><span class="comment"># 集合推导式</span></span><br><span class="line">&#123;k <span class="keyword">for</span> k <span class="keyword">in</span> obj.keys() <span class="keyword">if</span> k &lt; <span class="number">10</span>&#125;</span><br></pre></td></tr></table></figure>



<h1 id="单下划线和双下划线"><a href="#单下划线和双下划线" class="headerlink" title="单下划线和双下划线"></a>单下划线和双下划线</h1><p><code>__attr__</code>：一种约定，Python 内部的名字，用来区别其他用户自定义的命名，以防冲突</p>
<p><code>_attr</code>：一种约定，用来指定变量私有，无法使用 <code>from module import *</code> 导入</p>
<p><code>__attr</code>：解析器用 <code>_classname__attr</code> 来代替这个名字，以区别和其他类相同的命名。无法直接访问，可以通过 <code>obj._classname__attr</code> 方式访问</p>
<h1 id="容器、迭代器、可迭代对象、生成器"><a href="#容器、迭代器、可迭代对象、生成器" class="headerlink" title="容器、迭代器、可迭代对象、生成器"></a>容器、迭代器、可迭代对象、生成器</h1><p><strong>容器</strong>：一个把多个元素组织在一起的数据结构，可以使用 <code>in</code> 或 <code>not in</code> 关键字判断元素是否包含在容器中。实现这一功能的关键是实现 <code>__contains__</code> 函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.items = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__contains__</span>(<span class="params">self, item</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="keyword">return</span> item <span class="keyword">in</span> self.items</span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span> <span class="keyword">in</span> a)  <span class="comment"># True</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span> <span class="keyword">in</span> a)  <span class="comment"># False</span></span><br></pre></td></tr></table></figure>



<p><strong>迭代器</strong>：一个带状态的对象，可以使用 <code>for</code> 关键字迭代地获取容器中的值。实现这一功能的关键是实现 <code>__iter__</code> 和 <code>__next__</code> 两个函数。<code>__iter__</code> 用于返回迭代器本身，<code>__next__</code> 用于返回容器中的下一个值（如果没有更多元素会抛出 <code>StopIteration</code> 异常）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n</span>):</span><br><span class="line">        self.idx = <span class="number">0</span></span><br><span class="line">        self.n = n</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__next__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.idx &lt; self.n:</span><br><span class="line">            res = self.idx</span><br><span class="line">            self.idx += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> StopIteration</span><br><span class="line"></span><br><span class="line">a = A(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>([val <span class="keyword">for</span> val <span class="keyword">in</span> a])  <span class="comment"># [0, 1, 2]</span></span><br><span class="line"><span class="built_in">print</span>([val <span class="keyword">for</span> val <span class="keyword">in</span> a])  <span class="comment"># []，只能迭代一次</span></span><br><span class="line"><span class="built_in">next</span>(a)  <span class="comment"># StopIteration</span></span><br></pre></td></tr></table></figure>



<p><strong>可迭代对象</strong>：返回一个迭代器的对象。即实现了 <code>__iter__</code> 函数，但不一定实现了 <code>__next__</code> 函数，因此迭代器一定是可迭代对象，但可迭代对象不一定是迭代器</p>
<p><strong>生成器</strong>：一个特殊的迭代器。在生成器的 <code>__next__</code> 函数中使用 <code>yield</code> 关键字返回值。</p>
<ul>
<li>普通函数使用 <code>return</code> 关键字返回一个值，而生成器函数使用 <code>yield</code> 关键字。<code>yield</code> 可以只返回一个结果并记住上次暂停的位置，而 <code>return</code> 只能一次性地返回所有结果并结束</li>
<li>除了使用 <code>next</code> 函数启动生成器，还可以使用 <code>send</code> 函数，它可以传递一个值给生成器进行使用（在第一次执行生成器时只能传递 None 值，会抛出错误 <code>TypeError: can&#39;t send non-None value to a just-started generator</code>）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, n):</span><br><span class="line">        arg = <span class="keyword">yield</span> i</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;arg:&quot;</span>, arg)</span><br><span class="line"></span><br><span class="line">f = func(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;next:&quot;</span>, <span class="built_in">next</span>(f))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;send:&quot;</span>, f.send(<span class="number">100</span>))</span><br><span class="line">    <span class="keyword">except</span> StopIteration:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;stop&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">next: 0</span></span><br><span class="line"><span class="string">arg: 100</span></span><br><span class="line"><span class="string">send: 1</span></span><br><span class="line"><span class="string">arg: None</span></span><br><span class="line"><span class="string">next: 2</span></span><br><span class="line"><span class="string">arg: 100</span></span><br><span class="line"><span class="string">send: 3</span></span><br><span class="line"><span class="string">arg: None</span></span><br><span class="line"><span class="string">stop</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>列表生成式中 <code>[]</code> 改成 <code>()</code> 之后数据结构发生改变，从列表变成生成器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = [x*x <span class="keyword">for</span> x <span class="keyword">in</span> range(10)]</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span><br><span class="line">&gt;&gt;&gt; b = (x*x <span class="keyword">for</span> x <span class="keyword">in</span> range(10))</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line">&lt;generator object &lt;genexpr&gt; at 0x10440f6d0&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="args-和-kwargs"><a href="#args-和-kwargs" class="headerlink" title="*args 和 **kwargs"></a><code>*args</code> 和 <code>**kwargs</code></h1><p>在 Python 中，函数的参数（按顺序）分为位置参数、可变参数、关键字参数、命名关键字参数</p>
<p><code>*args</code> 代表可变参数，可以接收 0 个或任意多个参数，它会将传入的参数打包成一个元组。</p>
<p><code>**kwargs</code> 代表关键字参数，可以接收用 <code>参数名=参数值</code> 的方式传入的参数，传入的参数的会打包成一个字典。</p>
<h1 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h1><p>Python 作用域分为 4 种情况，搜索变量的优先级顺序为：局部作用域 &gt; 嵌套的父级函数的局部作用域 &gt; 全局作用域 &gt; 系统固定模块里的变量</p>
<ul>
<li>L：Local，局部作用域</li>
<li>E：Enclosing，嵌套的父级函数的局部作用域</li>
<li>G：Global，全局作用域，模块级别定义的变量</li>
<li>B：Built-in，系统固定模块里的变量</li>
</ul>
<p>在 Python 中，只有模块（<code>module</code>）、类（<code>class</code>）以及函数（<code>def</code>、&#96;&#96;lambda<code>）才会引入新的作用域，其他代码块（如</code>if<code>, </code>for<code>, </code>try&#96;）不会</p>
<h1 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h1><p>闭包需要满足的条件</p>
<ul>
<li>必须有一个嵌套函数</li>
<li>内嵌函数必须引用封闭函数中的变量</li>
<li>封闭函数返回值必须是内嵌函数</li>
</ul>
<h1 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h1><p>装饰器能够在不改变原有功能代码的基础上，添加额外的功能。如：权限校验、日志记录等</p>
<p>在编写装饰器时，会使用到 <code>@wraps</code> 装饰器，其作用是保证使用装饰器的原有函数的结果不会发生改变</p>
<ul>
<li><p>不使用 <code>@wraps</code> 装饰器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decorator</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;this is decorator __doc__&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;this is wrapper __doc__&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;this is test __doc__&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;__name__:&quot;</span>, test.__name__)  <span class="comment"># __name__: wrapper</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;__doc__:&quot;</span>, test.__doc__)  <span class="comment"># __doc__: this is wrapper __doc__</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>@wraps</code> 装饰器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decorator</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;this is decorator __doc__&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;this is wrapper __doc__&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;this is test __doc__&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;__name__:&quot;</span>, test.__name__)  <span class="comment"># __name__: test</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;__doc__:&quot;</span>, test.__doc__)  <span class="comment"># __doc__: this is test __doc__</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>除了上面的函数装饰器，还有类装饰器，实现这一功能的关键是实现 <code>__call__</code> 函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Decorator</span>：</span><br><span class="line">	<span class="comment"># 命名关键字参数前必须加 *（如果已经存在 *args 则不用）</span></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *, retry_time: <span class="built_in">int</span> = <span class="number">3</span>, max_wait_secs: <span class="built_in">int</span> = <span class="number">5</span>, errors = (<span class="params">Exception, </span>)</span>):</span><br><span class="line">        self.retry_time = retry_time</span><br><span class="line">        self.max_wait_secs = max_wait_secs</span><br><span class="line">        self.errors = errors</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, func</span>):</span><br><span class="line"><span class="meta">        @wraps(<span class="params">func</span>)</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(self.retry_times):</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">                <span class="keyword">except</span> self.errors:</span><br><span class="line">                    sleep(self.max_wait_secs)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>



<h1 id="鸭子类型"><a href="#鸭子类型" class="headerlink" title="鸭子类型"></a>鸭子类型</h1><p>一种编程风格，决定一个对象是否有正确的接口，关注点在于它的方法或属性，而不是它的类型。</p>
<p>鸭子类型无需使用 <code>type()</code> 或 <code>isinstance()</code> 进行检查，相反，它通常使用 <code>hasattr()</code> 来检查，或是 <code>EAFP</code> 编程</p>
<h1 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a>函数重载</h1><p>函数重载指的是在同一个作用域内，允许定义多个同名函数，但这些函数的参数类型、参数个数或者参数顺序必须不同。</p>
<p>Python 没有直接支持函数重载，因为 Python 是一种动态类型语言，且函数可以接受任何数量的参数，这使得直接依赖参数类型和数量的重载变得不太实用。</p>
<h1 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h1><p>1、使用 <code>__new__</code> 方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">hasattr</span>(cls, <span class="string">&quot;_instance&quot;</span>):</span><br><span class="line">            cls._instance = <span class="built_in">super</span>(Singleton, cls).__new__(cls, *args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> cls._instance</span><br></pre></td></tr></table></figure>

<p>2、共享属性（使用类属性，创建实例时把所有实例的 <code>__dict__</code> 指向同一个字典，这样它们具有相同的属性和方法）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span>:</span><br><span class="line">    _state = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, *args, **kwargs</span>):</span><br><span class="line">        obj = <span class="built_in">super</span>(Singleton, cls).__new__(cls, *args, **kwargs)</span><br><span class="line">        obj.__dict__ = cls._state</span><br><span class="line">        <span class="keyword">return</span> obj</span><br></pre></td></tr></table></figure>

<p>3、使用装饰器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">singleton</span>(<span class="params">cls</span>)</span><br><span class="line">	_instance = &#123;&#125;</span><br><span class="line"><span class="meta">    @wraps(<span class="params">cls</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_instance</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> _instance:</span><br><span class="line">            instance[cls] = cls(*args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> instance[cls]</span><br><span class="line">    <span class="keyword">return</span> get_instance</span><br></pre></td></tr></table></figure>

<p>4、import 方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my_singleton.py</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MySingleton</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">my_singleton = MySingleton()</span><br><span class="line"></span><br><span class="line"><span class="comment"># to use</span></span><br><span class="line"><span class="keyword">from</span> my_singleton <span class="keyword">import</span> my_singleton</span><br></pre></td></tr></table></figure>



<h1 id="旧式类和新式类"><a href="#旧式类和新式类" class="headerlink" title="旧式类和新式类"></a>旧式类和新式类</h1><p>Python2 中默认都是旧式类，只有显式的继承了 <code>object</code> 才是新式类，Python3 中将经典类移除，默认都是新式类，不必显式地继承 <code>object</code> 类</p>
<p>在旧式类中 <code>class</code> 和 <code>type</code> 是不同的概念，而在新式类中，<code>class</code> 和 <code>type</code> 是统一的概念</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 旧式类</span></span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(a.__class__)  <span class="comment"># &lt;class &#x27;__main__.A&#x27;&gt;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(a))  <span class="comment"># &lt;type &#x27;instance&#x27;&gt;</span></span><br><span class="line"><span class="comment"># 新式类</span></span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(a.__class__)  <span class="comment"># &lt;class &#x27;__main__.A&#x27;&gt;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(a))  <span class="comment"># &lt;class &#x27;__main__.A&#x27;&gt;</span></span><br></pre></td></tr></table></figure>

<p>在旧式类，继承顺序是从左到右，深度优先；而新式类是从左到右，广度优先</p>
<h1 id="全局解释器锁（Global-Interpreter-Lock，GIL）"><a href="#全局解释器锁（Global-Interpreter-Lock，GIL）" class="headerlink" title="全局解释器锁（Global Interpreter Lock，GIL）"></a>全局解释器锁（Global Interpreter Lock，GIL）</h1><p>CPython 的内存管理不是线程安全的，引入 GIL 这个互斥锁是为了阻止多个线程同时执行 Python 字节码</p>
<h1 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h1><p>Python 采用的是以引用计数为主，标记清除和分代回收为辅的垃圾回收策略</p>
<p><strong>引用计数</strong></p>
<p>每个对象维护一个用来记录该对象当前被引用的次数字段 <code>ob_refcnt</code>，当对象的引用计数为 0 时会被立即回收，并释放占用的空间</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;对象被销毁&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;before&quot;</span>)</span><br><span class="line">obj = A()</span><br><span class="line">obj = <span class="number">2</span>  <span class="comment"># 此时 A 的实例引用数量为 0，立即回收对象，并输出&quot;对象被销毁&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;after&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">before</span></span><br><span class="line"><span class="string">对象被销毁</span></span><br><span class="line"><span class="string">after</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>这种方式的优点是简单、实时性高；缺点是需要额外的空间来维护字段，且无法解决循环引用问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">dict</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;A 对象被销毁&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">dict</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;B 对象被销毁&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;before&quot;</span>)</span><br><span class="line">a, b = A(), B()</span><br><span class="line">a[<span class="string">&quot;b&quot;</span>], b[<span class="string">&quot;a&quot;</span>] = b, a</span><br><span class="line">a, b = <span class="number">1</span>, <span class="number">1</span>  <span class="comment"># 因为存在循环引用，所以对象的引用计数不是为 0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;after&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">before</span></span><br><span class="line"><span class="string">after</span></span><br><span class="line"><span class="string">A 对象被销毁</span></span><br><span class="line"><span class="string">B 对象被销毁</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>可以调用 <code>sys</code> 的 <code>getrefcount()</code> 返回对象的引用计数</p>
<p>导致引用计数加 1 的情况</p>
<ul>
<li>对象被创建。如 <code>a = 23</code></li>
<li>对象被引用。如 <code>b = a</code></li>
<li>对象被作为参数，传入到一个函数中。如 <code>func(a)</code></li>
<li>对象作为一个元素，存储在容器中。如 <code>list1 = [a, a]</code></li>
</ul>
<p>导致引用计数减 1 的情况</p>
<ul>
<li>对象别名被显式销毁。如 <code>del a</code></li>
<li>对象别名被赋予新的对象。如 <code>a = 24</code></li>
<li>一个对象离开他的作用域</li>
<li>对象所在的容器被销毁，或从容器中删除对象</li>
</ul>
<p><strong>标记清除</strong></p>
<p>可以解决循环引用问题</p>
<p>分为标记和清除两个阶段，在标记阶段会从根对象出发，对所有可达对象进行标记，在清除阶段会将不可达对象清除</p>
<p>缺点是需要控制回收的频次</p>
<p><strong>分代回收</strong></p>
<p>建立在标记清除的基础上，是一种以空间交换时间的操作方式。</p>
<p>根据对象的存活时间分为三代，在垃圾回收过程中，0代&#x2F;1代如果能够存活，则会放入到 1代&#x2F;2 代中</p>
<h1 id="触发垃圾回收机制方式"><a href="#触发垃圾回收机制方式" class="headerlink" title="触发垃圾回收机制方式"></a>触发垃圾回收机制方式</h1><p>1、调用 <code>gc.collect()</code></p>
<p>2、当 <code>gc</code> 模块的计数器达到域值时</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gc</span><br><span class="line"><span class="built_in">print</span>(gc.get_threshold())  <span class="comment"># (700, 10, 10)</span></span><br><span class="line"><span class="comment"># 当分配对象的个数 - 释放对象的个数 &gt; 700 时，产生一次 0 代回收</span></span><br><span class="line"><span class="comment"># 10 次 0 代回收会导致一次 1 代回收</span></span><br><span class="line"><span class="comment"># 10 次 1 代回收会导致一次 2 代回收</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以通过 gc.set_threshold() 设置阈值</span></span><br><span class="line">gc.set_threshold(<span class="number">600</span>, <span class="number">10</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<p>3、程序退出时</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" rel="tag"># 编程语言</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/02/19/KMP/" rel="prev" title="KMP">
      <i class="fa fa-chevron-left"></i> KMP
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/02/19/Java/" rel="next" title="Java">
      Java <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="nav-number">1.</span> <span class="nav-text">函数参数传递</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#type-%E5%87%BD%E6%95%B0"><span class="nav-number">2.</span> <span class="nav-text">type 函数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#new-%E5%92%8C-init"><span class="nav-number">3.</span> <span class="nav-text">__new__ 和 __init__</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%83%E7%B1%BB%EF%BC%88Metaclass%EF%BC%89"><span class="nav-number">4.</span> <span class="nav-text">元类（Metaclass）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E3%80%81%E7%B1%BB%E6%96%B9%E6%B3%95%E5%92%8C%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95"><span class="nav-number">5.</span> <span class="nav-text">静态方法、类方法和实例方法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B1%BB%E5%8F%98%E9%87%8F%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F"><span class="nav-number">6.</span> <span class="nav-text">类变量和实例变量</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%87%AA%E7%9C%81%E6%9C%BA%E5%88%B6"><span class="nav-number">7.</span> <span class="nav-text">自省机制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC%E5%BC%8F"><span class="nav-number">8.</span> <span class="nav-text">推导式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%95%E4%B8%8B%E5%88%92%E7%BA%BF%E5%92%8C%E5%8F%8C%E4%B8%8B%E5%88%92%E7%BA%BF"><span class="nav-number">9.</span> <span class="nav-text">单下划线和双下划线</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E3%80%81%E8%BF%AD%E4%BB%A3%E5%99%A8%E3%80%81%E5%8F%AF%E8%BF%AD%E4%BB%A3%E5%AF%B9%E8%B1%A1%E3%80%81%E7%94%9F%E6%88%90%E5%99%A8"><span class="nav-number">10.</span> <span class="nav-text">容器、迭代器、可迭代对象、生成器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#args-%E5%92%8C-kwargs"><span class="nav-number">11.</span> <span class="nav-text">*args 和 **kwargs</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">12.</span> <span class="nav-text">作用域</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%97%AD%E5%8C%85"><span class="nav-number">13.</span> <span class="nav-text">闭包</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="nav-number">14.</span> <span class="nav-text">装饰器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B"><span class="nav-number">15.</span> <span class="nav-text">鸭子类型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD"><span class="nav-number">16.</span> <span class="nav-text">函数重载</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="nav-number">17.</span> <span class="nav-text">单例模式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%A7%E5%BC%8F%E7%B1%BB%E5%92%8C%E6%96%B0%E5%BC%8F%E7%B1%BB"><span class="nav-number">18.</span> <span class="nav-text">旧式类和新式类</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E8%A7%A3%E9%87%8A%E5%99%A8%E9%94%81%EF%BC%88Global-Interpreter-Lock%EF%BC%8CGIL%EF%BC%89"><span class="nav-number">19.</span> <span class="nav-text">全局解释器锁（Global Interpreter Lock，GIL）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6"><span class="nav-number">20.</span> <span class="nav-text">垃圾回收</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A7%A6%E5%8F%91%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%E6%96%B9%E5%BC%8F"><span class="nav-number">21.</span> <span class="nav-text">触发垃圾回收机制方式</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bling"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Bling</p>
  <div class="site-description" itemprop="description">绳锯木断，水滴石穿</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2023-01 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bling</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
